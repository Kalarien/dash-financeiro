# üìã TUTORIAL: Atualiza√ß√£o Mensal do Dashboard - Do Notebook

**Reposit√≥rio GitHub:** https://github.com/Kalarien/dash-financeiro.git
**Deploy Streamlit:** Atualiza automaticamente quando voc√™ faz push para o GitHub

---

## üéØ VIS√ÉO GERAL

Este tutorial ensina como atualizar os dados do dashboard financeiro **remotamente do seu notebook**, quando voc√™ estiver viajando. O processo √© simples:

1. Clonar o reposit√≥rio no notebook
2. Atualizar os dados nos arquivos Python
3. Fazer commit e push para o GitHub
4. Streamlit detecta automaticamente e atualiza o deploy

**‚è±Ô∏è Tempo estimado:** 15-30 minutos

---

## üì¶ ANTES DE COME√áAR (Prepara√ß√£o do Notebook)

### 1. Instalar Git no Notebook (se n√£o tiver)

**Windows:**
```bash
# Baixar e instalar Git de: https://git-scm.com/download/win
# Ou usar winget:
winget install --id Git.Git -e --source winget
```

**Mac:**
```bash
brew install git
```

**Linux:**
```bash
sudo apt-get install git
```

### 2. Configurar Git (PRIMEIRA VEZ APENAS)

```bash
git config --global user.name "Seu Nome"
git config --global user.email "seu-email@exemplo.com"
```

### 3. Ter Acesso ao GitHub

- Certifique-se de que tem acesso ao reposit√≥rio: https://github.com/Kalarien/dash-financeiro
- Se usar autentica√ß√£o por senha, use um **Personal Access Token** (n√£o a senha normal)
  - Criar token: https://github.com/settings/tokens
  - Permiss√µes necess√°rias: `repo` (acesso completo ao reposit√≥rio)

---

## üöÄ PASSO A PASSO: ATUALIZA√á√ÉO MENSAL

### PASSO 1: Clonar o Reposit√≥rio (PRIMEIRA VEZ APENAS)

No notebook, abra o terminal e execute:

```bash
# Navegue at√© onde quer salvar o projeto
cd C:\
# Ou no Mac/Linux:
cd ~

# Clone o reposit√≥rio
git clone https://github.com/Kalarien/dash-financeiro.git

# Entre na pasta
cd dash-financeiro
```

**‚ö†Ô∏è IMPORTANTE:** Na primeira vez, o GitHub vai pedir suas credenciais:
- **Username:** seu username do GitHub
- **Password:** seu Personal Access Token (n√£o a senha normal!)

---

### PASSO 2: Atualizar o Reposit√≥rio Local

Se voc√™ j√° tem o reposit√≥rio clonado, sempre atualize antes de fazer mudan√ßas:

```bash
cd dash-financeiro
git pull origin main
```

---

### PASSO 3: Editar os Arquivos com Dados

Voc√™ precisa atualizar **3 arquivos Python** com os dados do novo m√™s:

#### üìÑ Arquivo 1: `modulo_fechamento_mes.py`

**Linha 53:** Atualizar o m√™s e ano
```python
st.markdown("### An√°lise Completa - OUTUBRO 2025")  # Mudar para o m√™s atual
```

**Linha 56:** Atualizar data e per√≠odo
```python
st.info("üìÖ **√öltima atualiza√ß√£o:** 01/11/2025 | **Per√≠odo:** Outubro 2025 (m√™s completo)")
```

**Linhas 67-96:** Atualizar m√©tricas de faturamento
```python
with col1:
    st.markdown(criar_metrica_card(
        "Faturamento Total",
        "R$ XXX.XXX,XX",  # ‚Üê ATUALIZAR com faturamento de outubro
        "XX transa√ß√µes + B2B",  # ‚Üê ATUALIZAR n√∫mero de transa√ß√µes
        "positive"
    ), unsafe_allow_html=True)

with col2:
    st.markdown(criar_metrica_card(
        "Faturamento B2B",
        "R$ XXX.XXX,XX",  # ‚Üê ATUALIZAR B2B de outubro
        "Vendas corporativas",
        "neutral"
    ), unsafe_allow_html=True)

# ... e assim por diante para col3 e col4
```

**Linhas 101-138:** Atualizar tabela de faturamento por adquirente
```python
df_faturamento = pd.DataFrame([
    {
        'Adquirente': 'B2B Corporativo',
        'Transa√ß√µes': '-',
        'Faturamento': 120000.00,  # ‚Üê ATUALIZAR valores
        '%': '46,7%',  # ‚Üê ATUALIZAR percentuais
        'Ticket M√©dio': '-',
        'Taxa': '-',
        'Status': 'üü¢ Empresarial'
    },
    # ... atualizar todos os adquirentes
])
```

**Linhas 167-196:** Atualizar m√©tricas de caixa
**Linhas 201-246:** Atualizar tabela de caixa por adquirente
**Linhas 267-315:** Atualizar comparativo Faturamento vs Caixa
**Linhas 321-353:** Atualizar resumo executivo

---

#### üìÑ Arquivo 2: `modulo_fluxo_caixa.py`

**Linha 19:** Atualizar m√™s no t√≠tulo
```python
st.markdown("### Posi√ß√£o Consolidada - NOVEMBRO 2025")  # M√™s atual
```

**Linha 20:** Atualizar data
```python
st.info("üìÖ **√öltima atualiza√ß√£o:** 01/11/2025")
```

**Linhas 23-64:** Atualizar dados dos gateways
```python
dados_gateways = [
    {
        'Gateway': 'Asaas',
        'Em Conta': 199242.36,  # ‚Üê ATUALIZAR saldo em conta
        'A Receber': 180404.30,  # ‚Üê ATUALIZAR valores a receber
        'Total': 199242.36 + 180404.30,
        'Status': 'üü¢ Ativo',
        'Cor': '#10b981'
    },
    # ... atualizar todos os gateways
]
```

**Linhas 192-200:** Atualizar observa√ß√µes (se necess√°rio)

---

#### üìÑ Arquivo 3: `modulo_faturamento_tempo_real.py`

Verifique se este arquivo tamb√©m tem dados hardcoded que precisam ser atualizados.

---

### PASSO 4: Testar Localmente (RECOMENDADO)

Antes de fazer push, teste se est√° funcionando:

```bash
# Instalar depend√™ncias (primeira vez apenas)
pip install -r requirements.txt

# Rodar o dashboard localmente
streamlit run app.py
```

Acesse http://localhost:8501 e verifique:
- Login funciona
- Dados de outubro aparecem corretamente
- Fluxo de Caixa est√° atualizado
- Nenhum erro aparece

---

### PASSO 5: Fazer Commit das Mudan√ßas

```bash
# Ver o que foi modificado
git status

# Adicionar os arquivos modificados
git add modulo_fechamento_mes.py modulo_fluxo_caixa.py modulo_faturamento_tempo_real.py

# Fazer commit com mensagem descritiva
git commit -m "Atualiza√ß√£o dados financeiros - Outubro 2025"
```

---

### PASSO 6: Enviar para o GitHub (Push)

```bash
git push origin main
```

**‚ö†Ô∏è Se pedir credenciais:**
- **Username:** seu username do GitHub
- **Password:** seu Personal Access Token

---

### PASSO 7: Verificar Deploy Autom√°tico no Streamlit

1. Acesse: https://share.streamlit.io/
2. Fa√ßa login com sua conta Streamlit
3. Veja a lista de apps
4. Clique no seu dashboard
5. Na aba "Logs", voc√™ ver√°:
   ```
   Detecting changes...
   Restarting app...
   App is live!
   ```

**‚è±Ô∏è Tempo de deploy:** 1-3 minutos ap√≥s o push

---

## üîç ONDE ENCONTRAR OS DADOS PARA ATUALIZAR

### Faturamento do M√™s
- Verificar extratos de: Asaas, Pagar.me, Stripe, Crypto
- Somar todas as transa√ß√µes do m√™s
- Separar B2B de B2C

### Fluxo de Caixa
- Entrar em cada gateway e verificar:
  - **Em Conta:** saldo dispon√≠vel agora
  - **A Receber:** valores confirmados mas ainda n√£o recebidos

### Taxas e Custos
- Verificar extratos banc√°rios
- Somar todas as taxas cobradas pelos gateways
- Incluir taxas de antecipa√ß√£o (se houver)

---

## üìä CHECKLIST DE ATUALIZA√á√ÉO MENSAL

Imprima ou salve este checklist:

```
‚ñ° 1. Coletar dados de todos os gateways de pagamento
‚ñ° 2. Calcular faturamento total do m√™s
‚ñ° 3. Verificar saldos em conta de cada gateway
‚ñ° 4. Verificar valores a receber confirmados
‚ñ° 5. Atualizar modulo_fechamento_mes.py:
    ‚ñ° Linha 53: M√™s/ano
    ‚ñ° Linha 56: Data de atualiza√ß√£o
    ‚ñ° Linhas 67-96: M√©tricas de faturamento
    ‚ñ° Linhas 101-138: Tabela de faturamento
    ‚ñ° Linhas 167-196: M√©tricas de caixa
    ‚ñ° Linhas 201-246: Tabela de caixa
    ‚ñ° Linhas 267-315: Comparativo
    ‚ñ° Linhas 321-353: Resumo executivo
‚ñ° 6. Atualizar modulo_fluxo_caixa.py:
    ‚ñ° Linha 19: M√™s/ano
    ‚ñ° Linha 20: Data de atualiza√ß√£o
    ‚ñ° Linhas 23-64: Dados dos gateways
‚ñ° 7. Testar localmente (streamlit run app.py)
‚ñ° 8. Fazer commit e push para GitHub
‚ñ° 9. Verificar deploy no Streamlit Cloud
‚ñ° 10. Acessar dashboard em produ√ß√£o e conferir
```

---

## üÜò TROUBLESHOOTING

### Problema: Git pede senha mas n√£o aceita

**Solu√ß√£o:** Voc√™ precisa usar um Personal Access Token, n√£o sua senha normal.

1. V√° em: https://github.com/settings/tokens
2. Clique em "Generate new token" > "Generate new token (classic)"
3. D√™ um nome: "Notebook Update Dashboard"
4. Marque: `repo` (acesso completo ao reposit√≥rio)
5. Clique em "Generate token"
6. **COPIE O TOKEN** (voc√™ n√£o ver√° de novo!)
7. Use este token como senha no Git

---

### Problema: Streamlit n√£o atualiza automaticamente

**Solu√ß√£o 1:** Verificar se o push foi bem-sucedido
```bash
git log -1  # Ver √∫ltimo commit
git status  # Ver se est√° tudo limpo
```

**Solu√ß√£o 2:** For√ßar redeploy manual no Streamlit
1. Acesse https://share.streamlit.io/
2. Clique nos 3 pontinhos do seu app
3. Clique em "Reboot app"

---

### Problema: Erro "ModuleNotFoundError" no deploy

**Solu√ß√£o:** Verificar se o arquivo `requirements.txt` est√° atualizado

```bash
# Ver o conte√∫do
cat requirements.txt

# Deve ter pelo menos:
streamlit>=1.28.0
pandas>=2.0.0
plotly>=5.15.0
openpyxl>=3.1.0
xlrd>=2.0.0
python-dateutil>=2.8.0
requests>=2.31.0
```

---

### Problema: Dashboard mostra erro ao carregar dados

**Solu√ß√£o:** Verificar se as planilhas Excel est√£o no reposit√≥rio

```bash
# Listar arquivos Excel
ls *.xlsx

# Adicionar se necess√°rio
git add "Matriz financeira.xlsx"
git commit -m "Adicionar planilha de dados"
git push origin main
```

---

## üìû COMANDOS √öTEIS

### Ver hist√≥rico de commits
```bash
git log --oneline
```

### Desfazer mudan√ßas locais (CUIDADO!)
```bash
git checkout -- modulo_fechamento_mes.py
```

### Ver diferen√ßas antes de commitar
```bash
git diff modulo_fechamento_mes.py
```

### Verificar URL do reposit√≥rio
```bash
git remote -v
```

---

## üîê SEGURAN√áA

### Personal Access Token
- **NUNCA** compartilhe seu token
- **NUNCA** fa√ßa commit de um arquivo com o token
- Guarde em local seguro (gerenciador de senhas)
- Se vazar, revogue imediatamente: https://github.com/settings/tokens

### Senha do Dashboard
Atual: `CulturaBuilder852@`

**‚ö†Ô∏è RECOMENDA√á√ÉO:** Migrar para vari√°vel de ambiente no futuro
- Ver: https://docs.streamlit.io/streamlit-community-cloud/deploy-your-app/secrets-management

---

## üìö RECURSOS ADICIONAIS

- **Documenta√ß√£o Git:** https://git-scm.com/doc
- **GitHub Docs:** https://docs.github.com/
- **Streamlit Cloud:** https://docs.streamlit.io/streamlit-community-cloud
- **Streamlit Secrets:** https://docs.streamlit.io/streamlit-community-cloud/deploy-your-app/secrets-management

---

## ‚úÖ RESUMO R√ÅPIDO (Para quem j√° sabe)

```bash
# 1. Atualizar reposit√≥rio local
cd dash-financeiro
git pull origin main

# 2. Editar arquivos
# - modulo_fechamento_mes.py (dados de outubro)
# - modulo_fluxo_caixa.py (saldos atualizados)

# 3. Testar localmente (opcional mas recomendado)
streamlit run app.py

# 4. Commit e push
git add modulo_fechamento_mes.py modulo_fluxo_caixa.py
git commit -m "Atualiza√ß√£o dados financeiros - Outubro 2025"
git push origin main

# 5. Aguardar deploy autom√°tico (1-3 min)
# 6. Verificar em produ√ß√£o
```

---

**üìÖ √öltima atualiza√ß√£o deste tutorial:** 28/10/2025
**‚úçÔ∏è Criado por:** Claude Code
**üîó Reposit√≥rio:** https://github.com/Kalarien/dash-financeiro.git

---

**üí° DICA FINAL:**

Fa√ßa um teste ANTES de viajar! Clone o reposit√≥rio no notebook, fa√ßa uma pequena mudan√ßa (ex: mudar uma cor), commit, push e veja se o deploy funciona. Assim voc√™ garante que tudo est√° configurado corretamente.

Boa viagem! üöÄ
